Виртуализации KVM и Proxmox

KVM (Kernel-based Virtual Machine). Эта система виртуализации появилась вслед за тем, 
как Intel и AMD добавили в свои процессоры аппаратную виртуализацию.
KVM это программный комплекс. Он состоит из модуля ядра Linux, проекта qemu и проекта libvirt. Вклад в развитие виртуализации внесла Red Hat.
Модуль ядра kvm.ko дает интерфейс доступа к памяти, в т.ч. и для эмуляции устройств. 
Проект libvirt специализируется на эмуляции устройств, а вот qemu это как раз ПО для создания виртуальных машин. 
Qemu и без этого всего умеет эмулировать устройства и даже процессоры разной архитектуры. 
Но благодаря kvm и libvirt скорость работы виртуальный машин qemu становится приемлемой для повседневного использования.
Утилит для управления хозяйством - virsh, virt-manager, oVirt, GKVM, QtEmu и т.д
Панель управления сервером Proxmox
целый программный комплекс, который позволяет управлять виртуальными машинами на базе qemu-kvm, а также создавать контейнеры на базе LXC
Серверы под управлением Proxmox можно объединять в кластер. 
А из панели можно управлять практически всеми параметрами сервера - сеть, дисковые хранилища, файрвол и т.д.

Два пути установки.
1. дистрибутив Proxmox
2. Установить панель из внешнего репозитория на сервер с Debian
особеность Proxmox в том, что для него поддерживается репозиторий только для дистрибутива Debian не менее 30 гб
По умолчанию sudo не ставится. Зато в инсталляторе мы задали пароль пользователя root 

Открываем файл /etc/hosts
В файле hosts должна быть запись подобна этой:
172.22.3.133 proxmoxtest.wpl.ru proxmoxtest
ip-адрес вашей виртуалки и ее хостнейм

Подключаем репозиторий
echo "deb http://download.proxmox.com/debian/pve buster pve-no-subscription" > /etc/apt/sources.list.d/pve-install-repo.list
wget http://download.proxmox.com/debian/proxmox-ve-release-6.x.gpg -O /etc/apt/trusted.gpg.d/proxmox-ve-release-6.x.gpg
chmod +r /etc/apt/trusted.gpg.d/proxmox-ve-release-6.x.gpg

Делаем upgrade системы
apt-get update && apt-get full-upgrade
После завершения upgrade выполняем установки необходимых пакетов:
apt-get install proxmox-ve postfix open-iscsi ifupdown2

Рекомендуется удалить пакет os-proper. Этот пакет позволяет при настройке загрузчика искать установленные на жестком диске ОС и добавять их в меню загрузчика.
apt-get remove os-proper

Грохнем лишние ядра : 
apt remove linux-image-amd64 'linux-image-4.19*'




















